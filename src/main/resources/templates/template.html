<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Template</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link href="../static/css/main.css" th:href="@{/css/main.css}" rel="stylesheet" />
  <style>
  </style>

</head>
<body class="d-flex flex-column h-100">
  <nav class="navbar navbar-expand navbar-dark bg-dark" aria-label="Second navbar example">
  <div class="container-fluid">
    <h1 class="d-flex align-items-center fs-4 text-white mb-0">
      <img src="../static/img/logo.svg" th:src="@{/img/logo.svg}"
           width="38" height="30" class="me-3" alt="Bootstrap">
      Todo-App
    </h1>
    <div class="collapse navbar-collapse navbar-options">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
        <!--
        In Thymeleaf, th:href="@{/}" dynamically generates the URL based on the application context
        (e.g., http://localhost:8080/ if running locally).
         -->
          <a class="nav-link active" aria-current="page" href="#" th:href="@{/}">Home</a>
        </li>
        <!--
        sec:authorize="isAuthenticated()" is a Thymeleaf Security attribute.
        This HTML element will be only rendered if the user is authenticated (logged in).
        -->
        <li class="nav-item" sec:authorize="isAuthenticated()">
          <a class="nav-link" href="#" th:href="@{/task}">Tasks</a>
        </li>
        <!--
         sec:authorize="hasRole('ROLE_ADMIN')" checks if the logged-in user has a specific role to render this HTML tag.
         -->
        <li class="nav-item" sec:authorize="hasRole('ROLE_ADMIN')">
          <a class="nav-link" href="#" th:href="@{/admin/}">Admin</a>
        </li>
      </ul>
      <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
          <!--
           <th-block> is a Thymeleaf utility tag that does not produce any HTML on its own; it's just a container
           for expressions.
               th:with="auth=${#authentication.getPrincipal()}"
               We store in a local variable (auth) the currently authenticated user object.
               #authentication represents the current Authentication object in the Spring Security context.
           -->
          <th-block th:with="auth=${#authentication.getPrincipal()}">
            <!-- This link will dynamically display the logged-in user's full name, or 'User' if not available.-->
            <a class="nav-link dropdown-toggle" href="#" id="dropdown03" data-bs-toggle="dropdown" aria-expanded="false" th:text="${auth.fullname ?: 'User'}">User</a>
          </th-block>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown03">
            <li>
              <!--
               When we click Logout this sends a POST request to /logout, Spring security intercepts that endpoint and:
                - Invalidated the HTTP session
                - Clears the authentication
                - Redirects you to a default URL (/login?logout)
               -->
              <form style="display:none" th:action="@{/logout}" method="POST" id="logoutForm"></form>
              <a class="dropdown-item" href="javascript:document.getElementById('logoutForm').submit()">Logout</a>
            </li>
          </ul>
        </li>
        <li class="nav-item" sec:authorize="!isAuthenticated()">
          <a class="nav-link" href="#" th:href="@{/login}">Login</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <main class="flex-shrink-0">
    <div class="container">
    </div>
  </main>
  <footer class="footer mt-auto py-3 bg-light fixed-bottom">
    <div class="container">
      <input class="form-check-input" type="checkbox" value="" id="flexCheckCheckedDisabled" checked disabled>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>